Bot для автозаполнения Google форм

Этот бот автоматически заполняет Google формы данными из Excel файла.

ВОЗМОЖНОСТИ

- Автоматическое заполнение Google форм данными из Excel
- Умное сопоставление вопросов формы с колонками Excel
- Поддержка различных типов вопросов (текст, выбор, множественный выбор)
- Настраиваемые задержки между отправками
- Возможность запуска в headless режиме
- Обработка синонимов и похожих ответов

УСТАНОВКА

1. Убедитесь, что у вас установлен Node.js (версия 14 или выше)
2. Клонируйте репозиторий
3. Установите зависимости:
   npm install

НАСТРОЙКА

1. НАСТРОЙКА GOOGLE ФОРМЫ

1. Откройте файл form_bot.js
2. Найдите строку с FORM_URL и замените YOUR_GOOGLE_FORM_URL_HERE на вашу ссылку Google формы:
   const FORM_URL = 'https://docs.google.com/forms/d/e/YOUR_FORM_ID/viewform';

2. ПОДГОТОВКА EXCEL ФАЙЛА С ДАННЫМИ

Бот автоматически сопоставляет заголовки колонок Excel с вопросами в Google форме. Подготовьте Excel файл следующим образом:

СТРУКТУРА EXCEL ФАЙЛА:
- Заголовки колонок должны соответствовать вопросам в Google форме
- Каждая строка - это один ответ на форму
- Формат файла: .xlsx или .xls

ПРИМЕР СТРУКТУРЫ EXCEL ФАЙЛА:

| Как часто вы пользуетесь платформой? | С какого устройства вы заходите? | Какие функции нужны в мобильном приложении? | Какие трудности испытываете? |
|--------------------------------------|----------------------------------|---------------------------------------------|------------------------------|
| Редко                                | Смартфон                         | Карта мероприятий, Запись на события        | Никакой логики               |
| Часто                                | Компьютер                        | Уведомления, Поиск                          | Сложно найти информацию      |

ПОДДЕРЖИВАЕМЫЕ ТИПЫ ВОПРОСОВ:

1. Вопросы с выбором (radio buttons):
   - Частота использования: "Редко", "Часто", "Иногда", "Никогда"
   - Устройство: "Смартфон", "Компьютер/ноутбук", "Планшет", "Другое"
   - Доверие к платформе: "Полностью", "Частично", "Не доверяю"

2. Текстовые поля:
   - Функции в мобильном приложении
   - Предложения по улучшению
   - Дополнительные комментарии

3. Специальные сопоставления:
   Бот автоматически сопоставляет ответы с вариантами в форме:

   // Примеры автоматических сопоставлений
   'редко' → 'Раз в месяц' / 'Реже одного раза в месяц'
   'смартфон' → 'Телефон'
   'whatsapp' → 'Социальные сети'
   'актуальная' → 'Всегда актуальна'

ВАЖНЫЕ МОМЕНТЫ:

1. Заголовки колонок должны быть максимально похожи на вопросы в форме
2. Пустые значения пропускаются (кроме специальных случаев)
3. Служебные колонки (например, "Отметка времени") автоматически пропускаются
4. Обязательные вопросы (с звездочкой *) заполняются автоматически, если не найдено соответствие

ПРИМЕРЫ НАЗВАНИЙ КОЛОНОК:

- "Как часто вы пользуетесь платформой?"
- "С какого устройства вы заходите?"
- "Какие функции нужны в мобильном приложении?"
- "Какие трудности испытываете при использовании?"
- "Что могло бы мотивировать вас использовать платформу чаще?"
- "Как вы оцениваете актуальность информации?"
- "Какие каналы для уведомлений предпочитаете?"
- "Доверяете ли вы платформе?"
- "Испытывали ли вы технические трудности?"

3. НАСТРОЙКА ФАЙЛА ДАННЫХ

По умолчанию используется файл moscow_sport_data.xlsx. Чтобы использовать свой файл:

1. Замените moscow_sport_data.xlsx на ваш файл
2. Или измените путь в коде:
   const EXCEL_FILE = path.join(__dirname, 'your_data_file.xlsx');

4. СОЗДАНИЕ GOOGLE ФОРМЫ

РЕКОМЕНДУЕМАЯ СТРУКТУРА GOOGLE ФОРМЫ:

1. Вопросы с выбором одного варианта (Radio buttons):

   Вопрос: "Как часто вы пользуетесь платформой?"
   Варианты ответов:
   - Ежедневно
   - Несколько раз в неделю  
   - Раз в месяц
   - Реже одного раза в месяц
   - Впервые

   Вопрос: "С какого устройства вы заходите?"
   Варианты ответов:
   - Телефон
   - Компьютер/ноутбук
   - Планшет
   - Другое

2. Текстовые поля:

   Вопрос: "Какие функции нужны в мобильном приложении?"
   Тип: Короткий текст или Длинный текст

   Вопрос: "Какие изменения хотели бы видеть в платформе?"
   Тип: Длинный текст

3. Вопросы с множественным выбором:

   Вопрос: "Какие каналы для уведомлений предпочитаете?"
   Варианты ответов:
   - Email
   - SMS
   - Push-уведомления
   - Социальные сети
   - Другое

НАСТРОЙКИ GOOGLE ФОРМЫ:

1. Создайте форму на forms.google.com
2. Добавьте вопросы в соответствии с вашими данными
3. Настройте обязательные вопросы (поставьте звездочку *)
4. Получите ссылку для заполнения (кнопка "Отправить" → "Ссылка")
5. Вставьте ссылку в код бота

ПРИМЕР ПОЛНОЙ GOOGLE ФОРМЫ:

1. Как часто вы пользуетесь платформой? *
   ○ Ежедневно
   ○ Несколько раз в неделю
   ○ Раз в месяц
   ○ Реже одного раза в месяц
   ○ Впервые

2. С какого устройства вы заходите? *
   ○ Телефон
   ○ Компьютер/ноутбук
   ○ Планшет
   ○ Другое

3. Какие функции нужны в мобильном приложении?
   [Текстовое поле]

4. Какие трудности испытываете при использовании? *
   ○ Нужную информацию сложно найти
   ○ Слишком много пунктов меню
   ○ Непонятны названия разделов
   ○ Другое

5. Что могло бы мотивировать вас использовать платформу чаще?
   ○ Система бонусов
   ○ Персональные рекомендации
   ○ Упрощение процесса
   ○ Другое

6. Как вы оцениваете актуальность информации? *
   ○ Всегда актуальна
   ○ Иногда устаревшая
   ○ Часто не соответствует действительности
   ○ Иногда не хватает деталей

7. Какие каналы для уведомлений предпочитаете?
   ○ Email
   ○ SMS
   ○ Push-уведомления
   ○ Социальные сети
   ○ Другое

8. Доверяете ли вы платформе? *
   ○ Полностью
   ○ Частично
   ○ Не доверяю

9. Испытывали ли вы технические трудности?
   ○ Периодически вылетает
   ○ Часто зависает
   ○ Интерфейс неудобный
   ○ Других особенностей
   ○ Нет проблем

10. Какие изменения хотели бы видеть в платформе?
    [Длинное текстовое поле]

ИСПОЛЬЗОВАНИЕ

ЧЕРЕЗ КОМАНДНУЮ СТРОКУ:
   node form_bot.js [START_ROW] [MAX_ROWS] [HEADLESS]

ЧЕРЕЗ BAT ФАЙЛ (WINDOWS):
   Отредактируйте run_bot.bat и запустите его.

ПАРАМЕТРЫ:
- START_ROW - начальная строка Excel (по умолчанию 0)
- MAX_ROWS - максимальное количество строк для обработки (по умолчанию все)
- HEADLESS - запуск в фоновом режиме (true/false, по умолчанию false)

ПРИМЕРЫ ЗАПУСКА:

# Обработать все строки, начиная с первой
node form_bot.js 0

# Обработать только первые 10 строк
node form_bot.js 0 10

# Запустить в фоновом режиме
node form_bot.js 0 null true

СТРУКТУРА ПРОЕКТА

- form_bot.js - основной файл бота
- moscow_sport_data.xlsx - файл с данными для заполнения
- run_bot.bat - скрипт для быстрого запуска на Windows
- package.json - зависимости проекта

ТРЕБОВАНИЯ

- Node.js 14+
- Excel файл с данными

ЗАВИСИМОСТИ И МОДУЛИ

Бот использует следующие npm пакеты (устанавливаются автоматически):

1. puppeteer (^24.12.0)
   - Автоматизация браузера Chrome/Chromium
   - Взаимодействие с веб-страницами
   - Заполнение форм и отправка данных

2. xlsx (^0.18.5)
   - Чтение и парсинг Excel файлов (.xlsx, .xls)
   - Преобразование данных в JSON формат
   - Поддержка различных форматов таблиц

3. string-similarity (^4.0.4)
   - Алгоритмы нечеткого сопоставления строк
   - Умное сопоставление вопросов Excel с вопросами формы
   - Обработка синонимов и похожих ответов

ПРИМЕЧАНИЕ ПО PUPPETEER:

При первом запуске Puppeteer автоматически скачает браузер Chromium (~200MB).
Это происходит только один раз при установке. Если у вас медленный интернет,
может потребоваться некоторое время для загрузки.

УСТАНОВКА МОДУЛЕЙ:

После клонирования репозитория выполните:
npm install

Это автоматически установит все необходимые зависимости из package.json

ФАЙЛ PACKAGE.JSON:

Все необходимые модули указаны в файле package.json:
- puppeteer (^24.12.0) - автоматизация браузера
- xlsx (^0.18.5) - работа с Excel файлами
- string-similarity (^4.0.4) - нечеткое сопоставление строк

При выполнении npm install эти модули будут автоматически установлены.

ПРОВЕРКА УСТАНОВКИ:

Чтобы убедиться, что все модули установлены корректно:
npm list

Или проверить конкретный модуль:
npm list puppeteer
npm list xlsx
npm list string-similarity

ОБНОВЛЕНИЕ МОДУЛЕЙ:

Для обновления модулей до последних версий:
npm update

Для обновления конкретного модуля:
npm update puppeteer

БЕЗОПАСНОСТЬ

⚠️ ВАЖНО: Не публикуйте ссылки на ваши Google формы в публичных репозиториях. Всегда используйте placeholder значения в коде.

ОТЛАДКА И УСТРАНЕНИЕ ПРОБЛЕМ

ЧАСТЫЕ ПРОБЛЕМЫ:

1. Бот не находит вопросы в форме:
   - Убедитесь, что ссылка на форму корректная
   - Проверьте, что форма доступна для заполнения
   - Попробуйте запустить в режиме headless=false для отладки

2. Неправильное сопоставление ответов:
   - Проверьте, что заголовки колонок Excel похожи на вопросы в форме
   - Убедитесь, что варианты ответов в Excel соответствуют вариантам в форме
   - Используйте точные названия вариантов из формы

3. Бот не заполняет обязательные поля:
   - Убедитесь, что в форме есть звездочки (*) для обязательных вопросов
   - Проверьте, что данные в Excel не пустые для обязательных полей

4. Ошибки при отправке формы:
   - Увеличьте задержки между отправками
   - Проверьте интернет-соединение
   - Попробуйте запустить в обычном режиме (не headless)

ЛОГИ И ОТЛАДКА:

Бот выводит подробные логи в консоль:
- 🔍 - поиск элементов
- ✅ - успешные операции
- ❌ - ошибки
- 🎯 - сопоставления
- 📝 - заполнение полей

НАСТРОЙКА ЗАДЕРЖЕК:

const DELAY_BETWEEN = [2000, 4000]; // Задержка между отправками (мс)

Увеличьте значения, если форма не успевает обрабатывать запросы.
